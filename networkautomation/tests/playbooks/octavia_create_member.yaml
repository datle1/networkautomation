- name: Update members of vLB
  hosts: localhost
  connection: local
  gather_facts: false
  tasks:
  - name: Update members of vLB
    openstack.cloud.lb_member:
      auth:
        auth_url: "{{ auth_url }}"
        username: "{{ username }}"
        password: "{{ password }}"
        project_name: "{{ project_name | default('admin') }}"
        user_domain_name: "{{ user_domain_name | default('Default') }}"
        project_domain_name: "{{ project_domain_name | default('Default') }}"
      name: "{{ item.name }}"
      pool: "{{ loadbalancer.pools[0].name }}"
      address: "{{ item.address }}"
      protocol_port: "{{ loadbalancer.pools[0].protocol_port }}"
      state: present
    loop: "{{ q('list', loadbalancer.pools[0].members[0]) }}"